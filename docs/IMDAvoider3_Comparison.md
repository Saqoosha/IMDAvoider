# IMDAvoider3との比較分析

## 概要
IMDAvoider3（https://github.com/nkozawa/IMDAvoider3）は、同様に3次IMDを考慮したツールです。当プロジェクトは現在、IMDAvoider3と同じ10パターンの3次IMDを実装していますが、重要な違いは重み付けシステムにあります。

## 主な違い

### 1. 3次IMDパターンの数

#### IMDAvoider3
- **10種類**の3次IMDパターンを計算
- より網羅的なアプローチ
- パターン例：
  1. f1 - f2 + f3
  2. f1 + f2 - f3
  3. 2×f1 - f2 - f3
  4. f1 + f2 + f3
  5. -f1 + f2 + f3
  6. 2×f1 + f2 - f3
  7. 2×f1 - f2 + f3
  8. f1 - 2×f2 + f3
  9. f1 + 2×f2 - f3
  10. -f1 + 2×f2 + f3

#### 当プロジェクト（更新済み）
- **10種類**の3次IMDパターンを実装（IMDAvoider3と同じ）
- 2周波数IMD（3種類）: 2×f2 - f1, f1 + 2×f2, 2×f1 + f2
- 3周波数IMD（10種類）: IMDAvoider3と同じ全パターン
- 数学的には16パターン存在するが、6つは負の周波数/帯域外を生成するため除外

### 2. 重み付けシステム

#### IMDAvoider3
- **重み付けなし**
- 2次IMDと3次IMDを同じ基準で評価
- すべての干渉を同等に扱う
- README.mdで「評価方法については引き続き検討」と記載

#### 当プロジェクト
- **科学的根拠に基づく重み付け**
- 2次IMD: 重み1.0（基準）
- 3次IMD（2周波数）: 重み0.1（-20dB）
- 3次IMD（3周波数）: 重み0.03（-30dB）
- 実際の信号強度差を反映

### 3. 評価スコアの計算

#### IMDAvoider3
```python
return round(RATING_MAX_VALUE - total / 5 / n)
```
- 正規化係数: 5
- 結果的に**負の評価値**になることが多い（例: -376）

#### 当プロジェクト
```python
return round(100 - total / (15 * n))
```
- 正規化係数: 15（3次IMDの追加を考慮）
- 常に0-100の範囲内の評価値

### 4. しきい値

#### IMDAvoider3
- すべてのIMDに対して**35 MHz**の単一しきい値

#### 当プロジェクト
- 2次IMD: **35 MHz**
- 3次IMD: **25 MHz**（近接チャンネル干渉を考慮）

### 5. ユーザビリティとドキュメント

#### IMDAvoider3
- LED番号との対応表示
- VTXテーブルからのチャンネル名表示
- 詳細なデバッグモード
- 日本のアマチュア無線バンドプランに特化

#### 当プロジェクト
- グラフィカルな可視化（matplotlib）
- IMD製品の視覚的表示
- 拡張評価とレガシー評価の比較
- 学術研究に基づくドキュメント

## 評価結果の比較

### 各ツールの最良組み合わせ（周波数範囲: 5670-5830 MHz）

| ツール | 最良の組み合わせ | 評価値 |
|--------|-----------------|--------|
| 当プロジェクト | [5695, 5725, 5790, 5820] | 97 |
| IMDAvoider3 | [5685, 5705, 5769, 5809] | -376 |

### IMDAvoider3の最良組み合わせを当プロジェクトで評価

周波数組み合わせ: [5685, 5705, 5769, 5809]

| 評価方法 | 評価値 | 備考 |
|---------|--------|------|
| IMDAvoider3 | -376 | IMDAvoider3での最良組み合わせ |
| 当プロジェクト（拡張） | 88 | 当プロジェクトでは10位以下 |
| 当プロジェクト（レガシー） | 65 | 2次IMDのみ |

## どちらを使うべきか？

### IMDAvoider3が適している場合
- すべての可能な3次IMDパターンを考慮したい
- 日本のアマチュア無線環境に特化した評価が必要
- LED表示システムとの連携が必要
- より保守的（厳しい）な評価を求める

### 当プロジェクトが適している場合
- 科学的根拠に基づく重み付けが必要
- 視覚的な分析結果が必要
- 実際の信号強度差を考慮した評価が必要
- 0-100の理解しやすいスコアが必要

## 技術的な考察

1. **パターン数の違い**: IMDAvoider3の10パターンは網羅的だが、一部は実際には発生しにくい可能性がある（例: f1 + f2 + f3）

2. **重み付けの重要性**: 3次IMDは2次IMDより20-30dB弱いという物理的事実を無視すると、過度に保守的な評価になる

3. **正規化の問題**: IMDAvoider3の負の評価値は、正規化係数が不適切なために発生している

4. **異なる最適解**: 両ツールが異なる組み合わせを最良と判断したのは、重み付けシステムの違いによる
   - IMDAvoider3: すべてのIMDを同等に扱うため、3次IMDの影響を過大評価
   - 当プロジェクト: 実際の信号強度に基づく重み付けで、より現実的な評価

## 結論

- IMDAvoider3: より**網羅的**で**保守的**なアプローチ
- 当プロジェクト: より**科学的**で**実用的**なアプローチ

両方のツールは補完的な関係にあり、用途に応じて選択すべきです。